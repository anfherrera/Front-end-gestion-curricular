<div class="paz-salvo-container">

  <!-- Documentos requeridos -->
  <div class="section required-docs">
    <h3>Documentación requerida</h3>
    <ul>
      <li *ngFor="let doc of requiredDocuments"
          [ngClass]="{'uploaded': isDocumentUploaded(doc), 'missing': !isDocumentUploaded(doc)}">
        {{ doc }}
        <mat-icon class="validation-icon" 
                  [ngClass]="{
                    'valid': isDocumentUploaded(doc),
                    'invalid': !isDocumentUploaded(doc)
                  }">
          {{ isDocumentUploaded(doc) ? 'check_circle' : 'error' }}
        </mat-icon>
      </li>
    </ul>
  </div>

  <!-- Subir archivos -->
  <div class="section upload-container">
    <h3>Adjuntar documentación requerida</h3>
    <label class="upload-btn" for="fileUpload">
      <mat-icon>upload</mat-icon> Subir archivo PDF
    </label>
    <input type="file" id="fileUpload" accept=".pdf" (change)="onFileSelected($event)" multiple>

    <table class="uploaded-files-table" *ngIf="uploadedFiles.length > 0">
      <thead>
        <tr>
          <th>Nombre del archivo</th>
          <th>Fecha de carga</th>
          <th>Validación</th>
          <th>Acción</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let file of uploadedFiles; let i = index">
          <td>{{ file.name }}</td>
          <td>{{ file.date | date:'dd/MM/yyyy' }}</td>
          <td>
            <mat-icon class="validation-icon"
                      [ngClass]="{
                        'valid': file.status === 'pendiente' || file.status === 'correcto',
                        'invalid': file.status === 'incorrecto' || file.status === 'no-requerido'
                      }">
              {{ getIconStatus(file) }}
            </mat-icon>
          </td>
          <td>
            <button mat-icon-button class="delete-icon-btn" (click)="removeFile(i)">
              <mat-icon>delete</mat-icon>
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <button class="submit-btn" 
            [ngClass]="{'enabled': canSubmit(), 'disabled': !canSubmit()}" 
            [disabled]="!canSubmit()" 
            (click)="submitRequest()">
      Enviar solicitud
    </button>
  </div>

  <!-- Seguimiento de solicitudes -->
  <div class="section requests-list">
    <h3>Seguimiento de solicitud</h3>
    <div *ngIf="(requests$ | async) as requests">
      <div *ngFor="let req of requests" class="request-item">
        <span><strong>Nombre solicitud:</strong> {{ req.studentName }}</span>
        <span><strong>Fecha:</strong> {{ req.date | date:'dd/MM/yyyy' }}</span>
        <span><strong>Estado:</strong> {{ req.state }}</span>
      </div>
      <div *ngIf="requests.length === 0">No hay solicitudes realizadas aún.</div>
    </div>
  </div>

</div>
