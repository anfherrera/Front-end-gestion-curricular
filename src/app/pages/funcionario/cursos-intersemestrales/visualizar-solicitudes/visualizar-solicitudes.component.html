<app-card-container title="Solicitudes de Cursos Intersemestrales de Verano">
  
  <!-- Filtros -->
  <div class="filtros-container" [formGroup]="filtroForm">
    <mat-form-field appearance="outline" class="filtro-field">
      <mat-label>Filtrar por materia</mat-label>
      <mat-select formControlName="materia">
        <mat-option value="todos">Todas las materias</mat-option>
        <mat-option *ngFor="let materia of materias" [value]="materia.id_materia">
          {{ materia.nombre_materia }} ({{ materia.codigo_materia }})
        </mat-option>
      </mat-select>
    </mat-form-field>
    
    <button mat-raised-button 
            color="primary" 
            (click)="cargarSolicitudes()"
            [disabled]="cargando">
      <mat-icon>refresh</mat-icon>
      Actualizar
    </button>
  </div>

  <!-- Loading -->
  <div *ngIf="cargando" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Cargando solicitudes...</p>
  </div>

  <!-- Tabla de solicitudes -->
  <div *ngIf="!cargando" class="solicitudes-container">
    <table mat-table [dataSource]="solicitudesFiltradas" class="mat-elevation-z8">
      
      <!-- Nombre Completo -->
      <ng-container matColumnDef="nombre">
        <th mat-header-cell *matHeaderCellDef>Nombre Completo</th>
        <td mat-cell *matCellDef="let solicitud">
          <div class="estudiante-info">
            <strong>{{ solicitud.objUsuario?.nombre_completo }}</strong>
          </div>
        </td>
      </ng-container>

      <!-- C贸digo -->
      <ng-container matColumnDef="codigo">
        <th mat-header-cell *matHeaderCellDef>C贸digo</th>
        <td mat-cell *matCellDef="let solicitud">
          <span class="codigo-text">{{ solicitud.objUsuario?.codigo }}</span>
        </td>
      </ng-container>

      <!-- Curso -->
      <ng-container matColumnDef="curso">
        <th mat-header-cell *matHeaderCellDef>Curso</th>
        <td mat-cell *matCellDef="let solicitud">
          <div class="curso-info">
            <strong>{{ solicitud.objCursoOfertadoVerano?.nombre_curso }}</strong>
            <small>{{ solicitud.objCursoOfertadoVerano?.codigo_curso }} - {{ solicitud.objCursoOfertadoVerano?.objMateria?.nombre_materia }}</small>
          </div>
        </td>
      </ng-container>

      <!-- Condici贸n -->
      <ng-container matColumnDef="condicion">
        <th mat-header-cell *matHeaderCellDef>Condici贸n</th>
        <td mat-cell *matCellDef="let solicitud">
          <span class="condicion-badge">{{ getCondicionTexto(solicitud.condicion) }}</span>
        </td>
      </ng-container>

      <!-- Fecha -->
      <ng-container matColumnDef="fecha">
        <th mat-header-cell *matHeaderCellDef>Fecha</th>
        <td mat-cell *matCellDef="let solicitud">
          {{ solicitud.fecha_solicitud | date:'short' }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['nombre','codigo','curso','condicion','fecha']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['nombre','codigo','curso','condicion','fecha'];"></tr>
    </table>

    <!-- Mensaje cuando no hay solicitudes -->
    <div *ngIf="solicitudesFiltradas.length === 0" class="sin-datos">
      <mat-icon>info</mat-icon>
      <p>No hay solicitudes para mostrar</p>
      <p *ngIf="filtroForm.get('materia')?.value !== 'todos'">Intenta cambiar el filtro de materia</p>
    </div>
  </div>

</app-card-container>
