<div class="funcionario-container">

  <!-- Pesta√±as para Pendientes y Procesadas -->
  <mat-tab-group>
    
    <!-- Pesta√±a 1: Pendientes de Procesar -->
    <mat-tab label="Pendientes de Procesar">
      <div class="tab-content">
        <app-card-container
          title="Solicitudes Pendientes de Procesar">
          
          <app-request-status-table
            #requestStatusTable
            [solicitudes]="solicitudes"
            [showOficio]="false"
            [showComentarios]="false"
            [showSeleccionar]="true"
            (solicitudSeleccionada)="onSolicitudSeleccionada($event)">
          </app-request-status-table>
          
          <p *ngIf="solicitudes.length === 0" class="no-solicitudes">
            No hay solicitudes pendientes de procesar
          </p>
        </app-card-container>
      </div>
    </mat-tab>

    <!-- Pesta√±a 2: Historial - Ya Procesadas -->
    <mat-tab label="Historial - Ya Procesadas">
      <div class="tab-content">
        <app-card-container
          title="Solicitudes Procesadas">
          
          <!-- Filtro por per√≠odo acad√©mico -->
          <div class="filtro-periodo">
            <app-periodo-filtro-selector
              label="Filtrar por per√≠odo acad√©mico"
              [mostrarTodos]="true"
              [incluirActual]="true"
              [mostrarInfo]="false"
              (periodoChange)="onPeriodoChange($event)">
            </app-periodo-filtro-selector>
          </div>
          
          <app-request-status-table
            [solicitudes]="solicitudesProcesadas"
            [showOficio]="false"
            [showComentarios]="false"
            [showSeleccionar]="false">
          </app-request-status-table>
          
          <p *ngIf="solicitudesProcesadas.length === 0" class="no-solicitudes">
            No hay solicitudes procesadas todav√≠a
          </p>
        </app-card-container>
      </div>
    </mat-tab>

  </mat-tab-group>

  <!-- üìå Documentaci√≥n de la solicitud seleccionada -->
  <app-card-container
    *ngIf="selectedSolicitud"
    title="Documentaci√≥n Adjunta">

    <!-- Mostrar comentario de rechazo si la solicitud est√° rechazada -->
    <div *ngIf="estaRechazada() && obtenerComentarioRechazo(selectedSolicitud)" class="comentario-rechazo">
      <mat-icon>error_outline</mat-icon>
      <div class="comentario-rechazo-content">
        <strong>Motivo del rechazo:</strong>
        <p>{{ obtenerComentarioRechazo(selectedSolicitud) }}</p>
      </div>
    </div>

    <app-documentation-viewer
      [documentos]="documentosDelEstudiante"
      [solicitudId]="selectedSolicitud.id_solicitud"
      [proceso]="'paz-salvo'"
      [servicio]="pazSalvoService"
      [puedeAgregarComentarios]="true"
      (comentarioAgregado)="onComentarioAgregado($event)">
    </app-documentation-viewer>

  </app-card-container>

  <!-- üìå Botones de acci√≥n para la solicitud -->
  <div class="botones-acciones" *ngIf="selectedSolicitud">
    <button mat-raised-button color="primary" (click)="aprobarSolicitudSeleccionada()">
      Aprobar Paz y Salvo
    </button>
    <button mat-raised-button color="warn" (click)="rechazarSolicitudSeleccionada()">
      Rechazar Paz y Salvo
    </button>
  </div>

</div>
