<div class="secretaria-container">

  <!-- Tabla de solicitudes pendientes usando componente genÃ©rico -->
  <app-card-container
    title="Solicitudes de Reingreso - SecretarÃ­a"
    icon="assignment">

    <app-request-status-table
      [solicitudes]="solicitudes"
      [showOficio]="false"
      [showComentarios]="false"
      [showSeleccionar]="true"
      (solicitudSeleccionada)="onSolicitudSeleccionada($event)">
    </app-request-status-table>

  </app-card-container>

      <!-- Contenedor para generar documento usando componente genÃ©rico -->
      <app-card-container
        *ngIf="selectedSolicitud"
        title="Generar Documento Oficio/ResoluciÃ³n"
        icon="description">

        <app-document-generator
          [solicitud]="selectedSolicitud"
          [template]="template"
          [proceso]="'reingreso'"
          [loading]="loading"
          (generarDocumento)="onGenerarDocumento($event)"
          (cancelar)="onCancelarGeneracion()">
        </app-document-generator>

      </app-card-container>

      <!-- Contenedor para subir PDF y enviar al estudiante -->
      <app-card-container
        *ngIf="selectedSolicitud && documentoGenerado"
        title="Subir PDF y Enviar al Estudiante"
        icon="upload">

        <div class="pdf-upload-section">
          <p class="instruction">
            ðŸ“„ <strong>Paso 1:</strong> El documento Word ha sido generado y descargado.<br>
            ðŸ“¤ <strong>Paso 2:</strong> Selecciona el archivo PDF y envÃ­alo al estudiante.
          </p>

          <!-- SelecciÃ³n de archivo PDF -->
          <div class="file-selection">
            <input
              type="file"
              accept=".pdf"
              (change)="onArchivoSeleccionado($event)"
              #fileInput
              class="file-input">

            <button
              mat-raised-button
              color="primary"
              (click)="fileInput.click()"
              class="select-file-btn">
              <mat-icon>attach_file</mat-icon>
              Seleccionar PDF
            </button>

            <span *ngIf="archivoPDF" class="selected-file">
              âœ… {{ archivoPDF.name }}
            </span>
          </div>

          <!-- BotÃ³n unificado -->
          <div class="action-buttons">
            <button
              mat-raised-button
              color="primary"
              [disabled]="!archivoPDF || subiendoPDF || enviandoPDF"
              (click)="enviarDocumento()"
              class="send-document-btn">
              <mat-icon>send</mat-icon>
              <span *ngIf="subiendoPDF">Subiendo PDF...</span>
              <span *ngIf="enviandoPDF">Enviando al Estudiante...</span>
              <span *ngIf="!subiendoPDF && !enviandoPDF">Enviar Documento</span>
            </button>
          </div>

          <!-- Barra de progreso -->
          <mat-progress-bar
            *ngIf="subiendoPDF || enviandoPDF"
            mode="indeterminate"
            class="progress-bar">
          </mat-progress-bar>
        </div>

      </app-card-container>

</div>
