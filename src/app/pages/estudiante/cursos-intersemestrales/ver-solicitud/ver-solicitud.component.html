<app-card-container title="Seguimiento de Actividades">
  <div *ngIf="cargando" class="cargando">Cargando seguimiento...</div>

  <!-- Resumen de actividades -->
  <div *ngIf="!cargando" class="resumen">
    <div class="resumen-item">
      <mat-icon class="resumen-icon">assignment</mat-icon>
      <div class="resumen-content">
        <h3>{{ solicitudes.length }}</h3>
        <p>Preinscripciones</p>
      </div>
    </div>
    
    <div class="resumen-item">
      <mat-icon class="resumen-icon">school</mat-icon>
      <div class="resumen-content">
        <h3>{{ inscripciones.length }}</h3>
        <p>Inscripciones</p>
      </div>
    </div>
    
    <div class="resumen-item total">
      <mat-icon class="resumen-icon">list_alt</mat-icon>
      <div class="resumen-content">
        <h3>{{ getTotalActividades() }}</h3>
        <p>Total Actividades</p>
      </div>
    </div>
  </div>

  <!-- Sección de Preinscripciones -->
  <div *ngIf="!cargando && solicitudes.length > 0" class="section">
    <h3>Preinscripciones</h3>
    <table mat-table [dataSource]="solicitudes" class="mat-elevation-z8">
      
      <!-- Curso -->
      <ng-container matColumnDef="curso">
        <th mat-header-cell *matHeaderCellDef>Curso</th>
        <td mat-cell *matCellDef="let solicitud">{{ solicitud.curso || 'N/A' }}</td>
      </ng-container>

      <!-- Fecha -->
      <ng-container matColumnDef="fecha">
        <th mat-header-cell *matHeaderCellDef>Fecha</th>
        <td mat-cell *matCellDef="let solicitud">{{ solicitud.fecha | date:'short' }}</td>
      </ng-container>

          <!-- Estado -->
          <ng-container matColumnDef="estado">
            <th mat-header-cell *matHeaderCellDef>Estado</th>
            <td mat-cell *matCellDef="let solicitud">
              <span class="estado-badge">
                {{ solicitud.estado }}
              </span>
            </td>
          </ng-container>

      <!-- Tipo -->
      <ng-container matColumnDef="tipo">
        <th mat-header-cell *matHeaderCellDef>Tipo</th>
        <td mat-cell *matCellDef="let solicitud">Preinscripción</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['curso','fecha','estado','tipo']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['curso','fecha','estado','tipo'];"></tr>
    </table>
  </div>

  <!-- Sección de Inscripciones -->
  <div *ngIf="!cargando && inscripciones.length > 0" class="section">
    <h3>Inscripciones</h3>
    <table mat-table [dataSource]="inscripciones" class="mat-elevation-z8">

      <!-- ID del curso -->
      <ng-container matColumnDef="cursoId">
        <th mat-header-cell *matHeaderCellDef>ID Curso</th>
        <td mat-cell *matCellDef="let inscripcion">{{ inscripcion.cursoId }}</td>
      </ng-container>

      <!-- Fecha -->
      <ng-container matColumnDef="fecha">
        <th mat-header-cell *matHeaderCellDef>Fecha</th>
        <td mat-cell *matCellDef="let inscripcion">{{ inscripcion.fecha | date:'short' }}</td>
      </ng-container>

          <!-- Estado -->
          <ng-container matColumnDef="estado">
            <th mat-header-cell *matHeaderCellDef>Estado</th>
            <td mat-cell *matCellDef="let inscripcion">
              <span class="estado-badge">
                {{ inscripcion.estado }}
              </span>
            </td>
          </ng-container>

      <!-- Tipo -->
      <ng-container matColumnDef="tipo">
        <th mat-header-cell *matHeaderCellDef>Tipo</th>
        <td mat-cell *matCellDef="let inscripcion">Inscripción</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['cursoId','fecha','estado','tipo']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['cursoId','fecha','estado','tipo'];"></tr>
    </table>
  </div>

  <!-- Mensaje cuando no hay actividades -->
  <div *ngIf="!cargando && solicitudes.length === 0 && inscripciones.length === 0" class="sin-datos">
    <mat-icon>info</mat-icon>
    <p>No tienes actividades registradas.</p>
    <p>Puedes realizar solicitudes o preinscribirte en cursos desde las opciones del menú.</p>
  </div>
</app-card-container>
