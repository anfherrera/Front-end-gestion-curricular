<app-card-container title="Mis Inscripciones y Preinscripciones">
  <div *ngIf="cargando" class="cargando">Cargando datos...</div>

  <!-- Sección de Preinscripciones -->
  <div *ngIf="!cargando && solicitudes.length > 0" class="section">
    <h3>Mis Preinscripciones</h3>
    <table mat-table [dataSource]="solicitudes" class="mat-elevation-z8">
      
      <!-- Curso -->
      <ng-container matColumnDef="curso">
        <th mat-header-cell *matHeaderCellDef>Curso</th>
        <td mat-cell *matCellDef="let solicitud">{{ solicitud.curso || 'N/A' }}</td>
      </ng-container>

      <!-- Fecha -->
      <ng-container matColumnDef="fecha">
        <th mat-header-cell *matHeaderCellDef>Fecha</th>
        <td mat-cell *matCellDef="let solicitud">{{ solicitud.fecha | date:'short' }}</td>
      </ng-container>

      <!-- Estado -->
      <ng-container matColumnDef="estado">
        <th mat-header-cell *matHeaderCellDef>Estado</th>
        <td mat-cell *matCellDef="let solicitud">
          <span [ngClass]="'estado-' + solicitud.estado.toLowerCase()">{{ solicitud.estado }}</span>
        </td>
      </ng-container>

      <!-- Tipo -->
      <ng-container matColumnDef="tipo">
        <th mat-header-cell *matHeaderCellDef>Tipo</th>
        <td mat-cell *matCellDef="let solicitud">Preinscripción</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['curso','fecha','estado','tipo']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['curso','fecha','estado','tipo'];"></tr>
    </table>
  </div>

  <!-- Sección de Inscripciones -->
  <div *ngIf="!cargando && inscripciones.length > 0" class="section">
    <h3>Mis Inscripciones</h3>
    <table mat-table [dataSource]="inscripciones" class="mat-elevation-z8">

      <!-- ID del curso -->
      <ng-container matColumnDef="cursoId">
        <th mat-header-cell *matHeaderCellDef>ID Curso</th>
        <td mat-cell *matCellDef="let inscripcion">{{ inscripcion.cursoId }}</td>
      </ng-container>

      <!-- Fecha -->
      <ng-container matColumnDef="fecha">
        <th mat-header-cell *matHeaderCellDef>Fecha</th>
        <td mat-cell *matCellDef="let inscripcion">{{ inscripcion.fecha | date:'short' }}</td>
      </ng-container>

      <!-- Estado -->
      <ng-container matColumnDef="estado">
        <th mat-header-cell *matHeaderCellDef>Estado</th>
        <td mat-cell *matCellDef="let inscripcion">
          <span [ngClass]="'estado-' + inscripcion.estado.toLowerCase()">{{ inscripcion.estado }}</span>
        </td>
      </ng-container>

      <!-- Acciones -->
      <ng-container matColumnDef="acciones">
        <th mat-header-cell *matHeaderCellDef>Acciones</th>
        <td mat-cell *matCellDef="let inscripcion">
          <button *ngIf="inscripcion.estado !== 'cancelada'" 
                  mat-raised-button 
                  color="warn" 
                  (click)="onCancelarInscripcion(inscripcion)">
            Cancelar
          </button>
          <span *ngIf="inscripcion.estado === 'cancelada'" class="estado-cancelada">
            Ya cancelada
          </span>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="['cursoId','fecha','estado','acciones']"></tr>
      <tr mat-row *matRowDef="let row; columns: ['cursoId','fecha','estado','acciones'];"></tr>
    </table>
  </div>

  <div *ngIf="!cargando && solicitudes.length === 0 && inscripciones.length === 0" class="sin-datos">
    <mat-icon>info</mat-icon>
    <p>No tienes inscripciones ni preinscripciones activas.</p>
    <p>Puedes preinscribirte en cursos desde la sección "Ver Lista de Cursos para Preinscripción".</p>
  </div>
</app-card-container>
